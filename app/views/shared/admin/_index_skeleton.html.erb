<% collection ||= @collection %>
<% viewing ||= controller_name.humanize %>
<% index_title ||= nil %>
<% nav_header_list_items ||= "" %>
<% skip_charting ||= false %>
<% rendered_chart ||= nil %>
<% render_sortable ||= true %>

<% admin_search_form ||= "" %>
<% table_view ||= render(partial: "table", locals: {collection:, render_sortable:}) %>

<%# time_range_column is only used for graphing %>
<% time_range_column ||= @time_range_column || "created_at" %>

<div class="admin-subnav">
  <div class="col-md-5">
    <h1>
      <% if index_title.present? %>
        <%= index_title %>
      <% else %>
        Manage
        <%= viewing %>
      <% end %>
    </h1>
  </div>

  <div class="col-md-7">
    <ul>
      <%= nav_header_list_items %>

      <% unless skip_charting %>
        <li class="nav-item">
          <%= link_to "graph", url_for(sortable_search_params.merge(render_chart: !@render_chart)), class: "nav-link #{@render_chart ? 'active' : ''}" %>
        </li>
      <% end %>
    </ul>
  </div>

  <%= render_admin_current_header %>
</div>

<% if !skip_charting && @render_chart %>
  <% if rendered_chart.nil? %>
    <%# NOTE: if you want to render_chart, you must include the local: chart_collection %>
    <%= column_chart time_range_counts(collection: chart_collection, column: time_range_column), stacked: true, thousands: "," %>
  <% else %>
    <%= rendered_chart %>
  <% end %>
<% end %>

<div class="mt-2 mb-4"><%= render partial: "/shared/period_select" %></div>

<% if admin_search_form.present? %>
  <%= admin_search_form %>
<% end %>

<%= render_admin_pagination_with_count(collection:, viewing:) %>

<%= table_view %>

<%= render_admin_pagination_with_count(collection:, skip_total: true) %>

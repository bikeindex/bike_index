!!!
%html
  %head
    = header_tags
    <link rel='shortcut icon' href='/fav.ico' />
    = stylesheet_link_tag 'documentation_v2', media: "all"
    = stylesheet_link_tag 'og_application', media: 'all'
    - api_version = 'v3'
    :javascript
      window.swagger_url = "#{ENV['BASE_URL']}/api/#{api_version}/swagger_doc";
    = stylesheet_link_tag "updated_styles", media: 'all'
    <link href='https://fonts.googleapis.com/css?family=Anonymous+Pro:400,400italic,700&subset=latin,latin-ext' rel='stylesheet' type='text/css'>
    = javascript_include_tag 'documentation_v2_and_v3'
    
  %body.swagger-section
    / { data: { spy: 'scroll', target: '.docs-section-list'}}
    / data-spy="scroll" data-target=".navbar"
    %header#header
      .content-header
        .container-fluid.bikes-nav
          .small-header
            %a.top-logo{ href: root_url }
              %span.stripey
              = image_tag "updated/home/logo.svg", class: 'logo'
          %form#api_selector.form
            .api-header-group.api-header-url
            .api-header-group.api-header-key
              %label{ for: 'baseUrl' }
                Access token
              %input#input_apiKey.form-control{:name => "apiKey", :placeholder => "api_key", :type => "text"}
            %a#explore.btn.binxbtn{:href => "#"}
              Explore
    %nav.docs-section-list#navmenu-fixed
      %a#m_ref_title{ href: "#ref_title" }
        Bike Index API V3
      %ul
        %li
          %a#m_ref_introduction{ href: "#ref_introduction" }
            Introduction
        %li
          %a#m_ref_cors{ href: "#ref_cors" }
            CORS
        %li
          %a#m_ref_errors{ href: "#ref_errors" }
            Errors
        %li
          %a#m_ref_the_word_bike{ href: "#ref_the_word_bike" }
            The word "bike"
        %li
          %a#m_ref_bike_urls{ href: "#ref_bike_urls" }
            Bike urls
        %li
          %a#m_ref_time{ href: "#ref_time" }
            Time
        %li
          %a#m_ref_authentication{ href: "#ref_authentication" }
            Authentication
      %a#m_ref_endpoints{ href: "#ref_endpoints" }
        Endpoints
      %ul
        %li
          %a#m_resource_search{ href: "#resource_search" }
            Search
        %li
          %a#m_resource_bikes{ href: "#resource_bikes" }
            Bikes
        %li
          %a#m_resource_me{ href: "#resource_me" }
            Me        
        %li
          %a#m_resource_manufacturers{ href: "#resource_manufacturers" }
            Manufacturers
        %li
          %a#m_resource_selections{ href: "#resource_selections" }
            Selections
            
      %a#m_ref_oauth{ href: "#ref_oauth" }
        OAuth
      %ul
        %li
          %a#m_ref_your_applications{ href: "#ref_your_applications" }
            Your applications
        %li
          %a#m_ref_plugins{ href: "#ref_plugins" }
            Plugins and external libraries
        %li
          %a#m_ref_oauth_flows{ href: "#ref_oauth_flows" }
            OAuth flows
        %li
          %a#m_ref_applications_authorized{ href: "#ref_applications_authorized" }
            Applications authorized
        %li
          %a#m_ref_sending_in_requests{ href: "#ref_sending_in_requests" }
            Sending access tokens
        %li
          %a#m_ref_refresh_tokens{ href: "#ref_refresh_tokens" }
            Refresh tokens


    .container-fluid
      .api-info-header

        :markdown
          #{render "documentation/api_v3/info_header"}
      
      .start-of-swagger-ui
        %h2
          Bike Index API V3 endpoints
          <a id="ref_endpoints"></a>

    #message-bar.swagger-ui-wrap &nbsp;

    #swagger-ui-container.swagger-ui-wrap
  
    .applications-panel#applications_list
      .container-fluid
        .clearfix
          %h2
            Your applications:
            %span.pull-right.less-strong
              = link_to "Add an application", "/oauth/applications"
            <a id="ref_your_applications"></a>
          - if @applications.present?
            = render 'api_v2_applications'
          - else
            %p
              You don't have any applications set up! To be able to use the API you will need to create an application and generate an access token.
            %p
              #{link_to "Add an application here", "/oauth/applications"}.

    .container-fluid
      .api-info-footer
        :markdown
          #{render "documentation/api_v2/info_footer"}

    .container-fluid
      .alert.alert-info.margined
        %p
          This documentation is generated by #{link_to "Swagger.io", "https://github.com/swagger-api/swagger-ui", target: '_blank'}. To learn more about Swagger and why it's awesome check out #{link_to "Swagger.io", "http://swagger.io/", target: '_blank'}.
        .form-group
          %label.control-label{ for: 'input_baseUrl' }
            Swagger doc url
          %input#input_baseUrl.form-control{:name => "baseUrl", :placeholder => "https://bikeindex.org/api/v3", :type => "text"}

    = render 'shared/footer_updated'

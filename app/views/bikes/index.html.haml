- stolenness = @interpreted_params[:stolenness]
- stolenness_desc = { 'proximity' => 'nearby stolen', 'non' => 'non-stolen', 'stolen' => 'stolen' }
.container
  .row.first-row
    .col-md-8
      %h1
        Search for #{stolenness_desc[stolenness]} bikes
    .col-md-4.ad-col
      .ad-block#top468x60
        
  .row
    .col-md-8
      = form_tag bikes_path, id: 'bikes_search_form', class: 'bikes-search-form', method: :get do
        .query-field-wrap
          / Create initial_opts so there is some functionality without JS
          / NVRMIND - hide query items if there is no JS, only show query
          = select_tag :query_items,                    |
            [],                                         |
            placeholder: 'Search bike descriptions',    |
            class: 'form-control query-field',          |
            multiple: true,                             |
            data: { initial: @selected_query_items_options.to_json }
          = text_field_tag :serial, params[:serial],    |
            placeholder: 'Search for serial number',    |
            class: 'form-control query-field'
        .search-button-wrap
          = button_tag(type: 'submit', class: 'searchit btn btn-primary') do
            :plain
              <svg id="search-button" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 29 29"><defs><style>.cls-1,.cls-2{fill:none;stroke:#fff;stroke-miterlimit:10;stroke-width:2px;}.cls-2{stroke-linecap:round;}</style></defs><title>searcher</title><circle class="cls-1" cx="10.39" cy="10.39" r="9.39"/><line class="cls-2" x1="17.03" y1="17.03" x2="28" y2="28"/></svg>
        .stolen-search-fields{ class: ('currently-hidden' unless stolenness == 'stolen_proximity') }
          = text_field_tag :location, params[:location], placeholder: 'Anywhere', class: 'form-control stolen-proximity'
          %span
            miles of
          = number_field_tag :distance, params[:distance] || 100, placeholder: '100', min: 1, class: 'form-control stolen-radius'
          %span
            within
          = hidden_field_tag :stolenness, params[:stolenness]

      .search-type-tabs{ data: { query: request.original_url.split('bikes?').last } }
        %ul.nav.nav-tabs{ role: 'tablist' }
          %li.nav-item.stolen-proximity
            %a#stolen_proximity_tab.nav-link{ href: '#', class: ('active' if stolenness == 'proximity'), role: 'tab' }
              Stolen within
              %span#search_distance
                X
              miles of
              %span#search_location
                you
              %span.count
          %li.nav-item.stolen-anywhere
            %a#stolen_tab.nav-link{ href: '#', class: ('active' if stolenness == 'stolen'), role: 'tab' }
              Stolen anywhere
              %span.count
          %li.nav-item.not-stolen
            %a#non_stolen_tab.nav-link{ href: '#', class: ('active' if stolenness == 'non'), role: 'tab' }
              Not marked stolen
              %span.count
  .row
    .col-md-8
      - if @bikes.present?
        %ul.bike-boxes
          = render partial: '/bikes/revised_bike', collection: @bikes, as: :bike
        .paginate-container.paginate-container-bottom
          = paginate @bikes
            

      - else
        %h3.no-exact-results
          No #{stolenness_desc[stolenness]} bikes matched your search

      / - if @secondary_bikes.present?
      /   %h3.secondary-matches
      /     Serial numbers close to
      /     %em
      /       #{params[:serial]}

      /   %ul.bike-boxes
      /     = render partial: '/bikes/revised_bike', collection: @secondary_bikes, as: :bike
    .col-md-4.ad-col
      .ad-block#right300x600

:javascript
  window.interpreted_params = #{@interpreted_params.to_json};

<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
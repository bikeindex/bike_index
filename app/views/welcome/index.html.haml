- cache 'root_head_wrap' do # Expired in recovery_displays_controller
  - @recovery_displays = RecoveryDisplay.limit(10)
  .container.home-header#home_headies
    %a 
      = t "welcome.phrases.phrase0"
      %br
      = link_to_unless_current t("welcome.button.language.english"), locale: "en" 
      %br
      = link_to_unless_current t("welcome.button.language.portuguese"), locale: "pt-br"

    %h1
      %a.home_header_link{href: choose_registration_path }
      = t "welcome.title.indexTitle"
      %span
        = t "welcome.title.subIndexTitle"
    .testimonial-container
      %h2.visuallyhidden
        Testimonials:
      - @recovery_displays.each_with_index do |recovery, i|
        - cache(recovery) do
          .testimonial-block{class: "testimonial-#{recovery.id}"}
            %p.testimonial-quote
              %span.ptestimonial
                = recovery.quote.html_safe
            %span.testimonial-user
              - if recovery.image.present?
                %img{ data: { lazy: recovery.image_url(:medium) }}
              - else
                %span.no-image-spacer
              - if recovery.quote_by
                %span.h3testimonial
                  = recovery.quote_by
              %span.h4testimonial
                - txt = recovery.bike.present? ? recovery.bike.type.titleize : 'Bike'
                - txt += " <span class='recover-date'>recovered #{l recovery.date_recovered, format: :dotted}</span>"
                - if recovery.link.present?
                  %a.recover-date{href: recovery.link}
                    = txt.html_safe
                - else
                  = txt.html_safe
                
    .wheeled
      %span.register-container
        = link_to t("welcome.button.register"), choose_registration_path, class: "btn binxbtn binxbtn-lg"
      %span.wheel-holder
        = image_tag "/assets/updated/home/wheel_white.png", alt: "(spinning wheel graphic)", id: 'wheeled_wheel', role: 'presentation', :"aria-hidden" => "true"
- cache('root_bike_count', expires_in: 5.minutes) do
  .home-subhead
    .container
      %h2
        = t "welcome.phrases.phrase1"
      
      %h3
        = t "welcome.texts.text1"
      %h3
        = t "welcome.phrases.phrase2"
        %a.scroll-to-ref{ href: "#how_it_works" }
        = t "welcome.words.word1"
        #{link_to t("welcome.phrases.phrase3"), choose_registration_path}.
      %h3
        = t "welcome.words.word2"
        <strong> 
        = t "welcome.words.word3" 
        #{number_with_delimiter(Bike.count)} 
        = t "welcome.words.word4"
        </strong> 
        = t "welcome.words.word5" 
        <strong>
        = t "welcome.words.word6"
        #{number_with_delimiter(StolenRecord.recovered.where("date_recovered < ?", Time.zone.now.beginning_of_day).count)}</strong> 
        = t "welcome.words.word7"

- cache 'root_home' do 
  .info-blocks
    .container
      %article
        = image_tag "/assets/updated/info_blocks/online.svg"
        %h2
          = t "welcome.words.word8"
        %p
          = t "welcome.texts.text2" 

      %article
        = image_tag "/assets/updated/info_blocks/secured.svg"
        %h2
          = t "welcome.words.word9"
        %p
          = t "welcome.texts.text3"

      %article
        = image_tag "/assets/updated/info_blocks/free.svg"
        %h2
          = t "welcome.words.word10"
        %p
          = t "welcome.texts.text4"

  .how-it-works#how_it_works
    .container
      %h2
        = t "welcome.phrases.phrase4"
      %p
        = t "welcome.texts.text5"
      %p
        = t "welcome.texts.text6"
      %p
        = t "welcome.texts.text7"

      %p
        / Have any questions? Join the discussion #{link_to 'here', 'https://discuss.bikeindex.org'}.

    
  .bike-background
    .supporters
      .container
        %h2
          = t "welcome.words.word11"
        %ul.horizontal-list
          %li
            %a{href: "http://www.peopleforbikes.org/", target: "_blank"}
              = image_tag "/assets/supporters/people_for_bikes.png", alt: "People for bikes logo", title: "People for bikes"
          %li
            %a{href: "http://trailnet.org/", target: "_blank"}
              = image_tag "/assets/supporters/trailnet.png", alt: "Trailnet logo", title: "Trailnet"
          %li
            %a{href: "http://bikepgh.org/", target: "_blank"}
              = image_tag "/assets/supporters/bike_pgh.png", alt: "Bike Pittsburgh logo", title: "Bike Pittsburgh"
          %li
            %a{href: "https://www.BikeEastBay.org/", target: "_blank"}
              = image_tag "/assets/supporters/bike_east_bay.png", alt: "Bike East Bay logo", title: "Bike East Bay"
          %li
            %a{href: "http://indycog.org/", target: "_blank"}
              = image_tag "/assets/supporters/indycog.png", alt: "INDYCOG logo", title: "INDYCOG"
          %li
            %a{href: "http://www.activetrans.org/", target: "_blank"}
              = image_tag "/assets/supporters/active_trans1.png", alt: "Active Transportation Alliance logo", title: "Active Transportation Alliance"
        %ul.horizontal-list.five-supporters
          %li
            %a{href: "http://www.seattle.gov/police/", target: "_blank"}
              = image_tag "/assets/supporters/seattlepd.png", alt: "Seattle police"
          %li
            %a{href: "https://stlouis-mo.gov/", target: "_blank"}
              = image_tag "/assets/supporters/st_louis.png", alt: "City of Saint Louis"
          %li
            %a{href: "http://sf-police.org/", target: "_blank"}
              = image_tag "/assets/supporters/sfpd.png", alt: "San Francisco Police Department logo", title: "San Francisco Police Department logo"
          %li
            %a{href: "http://www.ci.berkeley.ca.us/police/", target: "_blank"}
              = image_tag "/assets/supporters/berkeley_pd.png", alt: "Berkeley Police Department logo", title: "Berkeley Police Department logo"
          %li
            %a{href: "https://www.portlandoregon.gov/police/66825", target: "_blank"}
              = image_tag "/assets/supporters/pbttf.png", alt: "Portland Bike Theft Task Force", title: "Portland Bike Theft Task Force"
          
          
      
      %p.and-many-more
        = t "welcome.phrases.phrase5"
        #{link_to t("welcome.phrases.phrase6"), where_path}

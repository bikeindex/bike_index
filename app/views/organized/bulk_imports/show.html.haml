.mb-4
  %h1.uncap
    - if @bulk_import.ascend?
      = translate_with_args(".ascend_import")
    - elsif @bulk_import.impounded?
      = translate_with_args(".bulk_import_impounded")
    - else
      = translate_with_args(".bulk_import")
    = link_to "superadmin", admin_bulk_import_path(@bulk_import.to_param), class: "btn btn-outline-info less-strong float-right"
%table.table-list
  %tbody
    %tr
      %td
        = translate_with_args(".created")
      %td
        %span.convertTime
          = l @bulk_import.created_at, format: :convert_time

    %tr
      %td
        = translate_with_args(".progress")
      %td
        = render partial: "/organized/bulk_imports/progress_display", locals: {bulk_import: @bulk_import, show_extended: true}
    %tr
      %td
        = translate_with_args(".file")
      %td
        - if @bulk_import.file_cleaned?
          %span.text-warning= translate_with_args(".file_removed")
          %em.small.less-strong= translate_with_args(".file_removed_explanation")
        - else
          = link_to @bulk_import.file_url.truncate(100), @bulk_import.file_url
    %tr
      %td
        = translate_with_args(".creator")
      %td
        - if @bulk_import.user.present?
          = @bulk_import.user.display_name
        - else
          \-
    - if permitted_kinds.count > 1
      %tr
        %td Kind
        %td= @bulk_import.kind_humanized


%hr{ style: "margin: 15px 0;" }
- if @bulk_import.import_errors?
  %h2= translate_with_args(".errors")
  - if @bulk_import.import_errors.present?
    = render partial: "/organized/bulk_imports/error_display", locals: {bulk_import: @bulk_import}
  %hr

.paginate-container
  %h2.uncap.float-left{ style: "margin-top: 28px;" }
    = translate_with_args(".bikes")
    %small
      = @bikes.total_count
  .paginate{ style: "margin: 12px auto 12px 0;" }
    = paginate @bikes

- show_impounded_id = @bulk_import.impounded? && @bulk_import.headers.present? && @bulk_import.headers.include?("impounded_id")

%table.table.table-striped.table-hover.table-bordered.table-sm.without-exterior-border
  %thead.small-header
    %tr
      %th= translate_with_args(".created")
      %th= translate_with_args(".manufacturer")
      %th= translate_with_args(".model")
      %th= translate_with_args(".color")
      %th= translate_with_args(".sent_to")
      - if @bulk_import.impounded?
        %th= translate_with_args(".impounded_at")
        - if show_impounded_id
          %th= translate_with_args(".impounded_id")
  %tbody
    - @bikes.each do |bike|
      %tr
        %td
          = link_to l(bike.created_at, format: :convert_time), bike_path(bike), class: "convertTime"
        %td
          = bike.mnfg_name
        %td
          = bike.frame_model
        %td
          = bike.frame_colors.to_sentence
        %td
          = bike.first_owner_email
          %small.less-strong
            - if bike.creation_description
              = origin_display(bike.creation_description)
            - unless bike.owner_email == bike.first_owner_email
              = translate_with_args(".sent_to_a_new_owner")
        - if @bulk_import.impounded?
          - impound_record = bike.impound_records.first
          %td
            - if impound_record.present?
              = link_to l(impound_record.impounded_at, format: :convert_time), organization_impound_record_path(impound_record.display_id, organization_id: impound_record.organization_id), class: "convertTime"
          - if show_impounded_id
            %td= impound_record.display_id

%h1
  Multi manufacturer update
%label.checkbox.disabled
  = check_box_tag :time_ordered, 'time_ordered', session[:missing_manufacturer_time_order]
  Time ordered


= form_tag update_manufacturers_admin_bikes_path, id: 'multi_bike_manufacturer_update' do
  .row
    .col-md-4
      .fancy-select.unfancy
        = select_tag :manufacturer_id, options_from_collection_for_select(Manufacturer.frames, :id, :name), prompt: "Choose manufacturer"
    .col-md-2
      = submit_tag 'Update selected', class: 'btn btn-primary'
  = paginate @bikes, views_prefix: "admin"
  .full-screen-table-wrapper
    %table.table.table-striped.table-bordered.table-sm
      %thead.thead-light
        %th.table-cell-check
          &#x2713;
        %th
          Date indexed
        %th
          Manufacturer
        %th
          Info
        %th
          Created by

      %tbody
        - @bikes.each do |bike|
          %tr
            %td
              = check_box_tag "bikes_selected[#{bike.id}]", bike.id
            %td
              .less-strong-hold
                %span.less-strong-right
                  - if bike.example
                    %span.table-error
                      = bike.id
                  - else
                    = bike.id
              %a{href: edit_admin_bike_url(bike) }

                - if bike.created_at.today?
                  Today at #{bike.created_at.strftime("%-I %p")}
                - elsif Date.yesterday().beginning_of_day() <= bike.created_at
                  Yesterday at #{bike.created_at.strftime("%-I %p")}
                - else
                  = bike.created_at.strftime("%-m.%-d.%Y")

            %td
              - if bike.manufacturer_other.present?
                %span
                  %span.hidden
                    0 1
                  = bike.manufacturer_other
              - else
                = bike.mnfg_name
            %td
              .less-strong-hold
                - desc = ''
                - desc += "#{bike.year} " if bike.year.present?
                - desc += "#{bike.frame_model} " if bike.frame_model.present?
                - desc += "(#{bike.type})" unless bike.type == 'bike'
                = desc
                - if bike.paint.present? && bike.paint.color_id.blank?
                  .less-strong
                    = link_to bike.paint.name, edit_admin_paint_url(bike.paint)
                    = bike.frame_colors.to_sentence
                - if bike.stolen
                  %span.less-strong-right
                    stolen

            %td
              .less-strong-hold
                = bike.creation_organization.name if bike.creation_organization.present?
                - if bike.registered_new
                  %span.less-strong-right
                    pos


  = paginate @bikes, views_prefix: "admin"
